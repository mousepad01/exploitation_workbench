from utils import to_bytes, from_bytes

with open("libcdata.bin", "rb") as fin:
    b = fin.read()

base_addr = 0x00007f0601a53000
end_addr = 0x00007f0601c8f000

bout = b''
for i in range(0, len(b), 8):

    addr = from_bytes(b[i:i + 8])

    if base_addr <= addr <= end_addr:
        addr -= base_addr

    bout += to_bytes(addr)

with open("libcdata_woffset.bin", "wb+") as fout:
    fout.write(bout)
